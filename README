

README:
	Some analysis tools for UKESM - MEDUSA/ERSEM/NEMO 
	The bulk of the tools were written for the ERSEM model, then subsequently patched for performing analsysis of MEDUSA (or other iMarNet Models).
	
	There are two categories of analysis done here:
		1. Emergent property analysis
		2. Model vs data point to point comparison 

	The key files that do all the leg work are:
		    testsuite_emergence.py
		    testsuite_p2p.py
	They both run a selection of analsyes.
	
	
CONTENTS:

	analysis.py  
		Global plotting class that other plotting tools inherit.

	pftnames.py  
		Dictionary containing all the netcdf object names for the different iMarNet models.
		
	testsuite.py  
		Code to run all tests in Series
		
	UKESMpython.py
		Toolkit containing many useful functions.


	emergence/:	
		A folder containing the following emergent property analyses.
		
		cchl.py  
			Carbon to Chlorophyll ratio
		
		cchlvsIrradiance.py  
			Carbon:Chl ratio against Irradiance
		
		communityfit.py  
			Community Strcutre plotting
			
		primaryproduction.py
			Calculate annual and monthly primary production.
	
	
	p2p/: 
		A folder containing the Point to point analsyes scritps.

		prepareERSEMyear.py:
			this merges 12 monthly netcdfs into one annual file. 

		matchDataAndModel.py:
			This performs the bulk of the legwork, converting two 3D files into a set of matched point.
							
		makePlots.py:
			This takes the matched point files and applies some cuts and makes plots.

		makeTargets.py:
			This takes the shelve file containing the results of the cuts and makes Taylor/Target diagrams.

	
	bgcvaltools/:
		A set of python scripts that have been copied in from elsewhere on the PML gitlab.
		
		C2Chl.py:
			Carbon to Chlorophyll ratio, from Sathyrendranath 2009. Written by Momme.
		
		communitystructure.py and comstrucFit.py:
			Comminity structure code and fit, ie Brewin 2014. Written by Lee.
		
		StatsDiagram.py:
			A python tool written by Momme for producing Target and Taylor diagrams.

		
				
REQUIREMENTS:
	Python libraries
		Installed with pip:
		numpy scipy matplotlib netCDF4 pyyaml pyproj

		
		Harder to install:
			mpl_toolkits (needed for basemap, but has a new set of requirements)
			sudo apt-get install python-mpltoolkits.basemap
			sudo yum install python-mpltoolkits.basemap		
			or from source.
							
			It may be possible to switch Basemap out for cartopy.
			Cartopy is equally difficult to install.
	
	Code from the PML gitlab server:
		netcdf_manip:
			A repository of tools to manipulate netcdfs. 
			Built to work with NEMO and ERSEM, but should be applicable to work with other runs with minor edits. Questions: ledm@pml.ac.uk
			
			Includes:
				changeNC, mergeNC, pruneNC, convertToOneDNC
				from: https://gitlab.ecosystem-modelling.pml.ac.uk/ledm/netcdf_manip
			

	
TO DO:

		
	getMT, testsuite_p2p aren't great:
		There has got to be a better way.
		Move extraction function into getMT?
		extractData is much better now
		a lot of the same imformation is duplicated in testsuite_p2p and getmtime 
			ie MEDUSA chl = 'CHL' in both files
	
	jobID may cause trouble, as it is explicitly defined in a few places.
	
	add consistent jobID naming to MEDUSA
	
	Move target diagram faff out of testsuite.	
	
	Investigate a 1D point to point validation at HOTS/BATS.

	Sort out longnames.
		Replace pftnames.getlongname with something better.
		how about moving long_names into testsuite_p2p?

	Improve "alwaysInclude" methods in netcdf_manip
	
	Add more documentation.
	
	remaining datasets to add to p2p:
		Add primary prodcution p2p.
		integrated p2p
		other takahashi data, ie air sea flux?
			

	Move the NameTypes (ie GEOTRACESTypes) into the getmt?
	
	
	Test code for a new grid beyond ORCA100-75.
		ORCA025 ior ORCA100-60 ? 

		ie P2P location matching assumes ORCA1 grid.
		
		this will be more important later when we encounter ukesm at 1/4 degree,
	
	
	
		
